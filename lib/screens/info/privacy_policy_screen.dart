// lib/screens/profile/privacy_policy_screen.dart
import 'package:flutter/material.dart';
import 'package:flutter_markdown/flutter_markdown.dart';
import 'package:mobile/widgets/base_layout.dart';

const String _privacyMarkdown = r'''
# Политика конфиденциальности приложения **InfoGo**

Дата обновления: 02.12.2025  

Настоящая Политика конфиденциальности (далее — «Политика») описывает, как приложение **InfoGo** (далее — «Приложение», «мы») обрабатывает персональные данные и другую информацию пользователей (далее — «Пользователь», «вы»).

Используя Приложение, вы подтверждаете, что прочли и поняли данную Политику.

---

## 1. Кто мы

Разработчик и оператор Приложения:  
**Моисеев Сергей Анатольевич**  

Контакт для вопросов по персональным данным:  
**Email:** infogouzbekistan@gmail.com

---

## 2. Какие данные мы собираем

Мы собираем данные в следующих категориях:

### 2.1. Данные аккаунта

Если вы создаёте учётную запись или авторизуетесь:

- Имя / никнейм  
- Адрес электронной почты  
- Аватар / фотография профиля  
- Язык интерфейса  
- Город, выбранный в Приложении  

### 2.2. Геолокация

При вашем согласии Приложение может получать:

- Примерное местоположение (по сети)  
- Точное местоположение (по GPS) — для отображения мест «рядом со мной», построения маршрутов и улучшения рекомендаций.

Вы всегда можете отключить доступ к геолокации в настройках устройства. В этом случае часть функций (поиск рядом, контекстные подсказки) может работать ограниченно.

### 2.3. Данные о местах, событиях и активности

- Просмотренные карточки мест и событий  
- Добавленные в избранное места  
- Оставленные отзывы и оценки  
- История просмотренных мест, новостей и событий (если включена)  

Эти данные помогают делать рекомендации более точными и удобными.

### 2.4. Технические и аналитические данные

В процессе использования Приложения мы можем автоматически собирать:

- Модель устройства, версия ОС  
- Версия Приложения  
- Время и продолжительность сессий  
- Ошибки и крэши приложения  
- Обезличенную статистику использования (например, какие экраны открывались чаще)

Такие данные используются для поддержки работоспособности, улучшения качества и анализа функционала.

---

## 3. Как мы используем данные

Мы используем полученные данные для:

1. **Работы основных функций Приложения**  
   - отображение справочника мест, событий и новостей по выбранному городу;  
   - показ мест и событий рядом с вами (при включённой геолокации);  
   - сохранение избранного и истории.

2. **Персонализации**  
   - рекомендации мест, событий и новостей, которые могут быть вам интересны;  
   - сохранение ваших настроек (язык, город и т.д.).

3. **Коммуникаций с вами**  
   - ответы на обращения в поддержку;  
   - уведомления об изменениях в работе Приложения (при включённых уведомлениях).

4. **Аналитики и улучшения**  
   - анализ того, как пользователи взаимодействуют с Приложением;  
   - поиск и исправление ошибок;  
   - планирование новых функций.

---

## 4. Правовые основания обработки

Мы обрабатываем данные на следующих основаниях:

- **Согласие пользователя** — например, на получение геолокации или рассылки уведомлений.  
- **Исполнение договора (оферты)** — предоставление функционала Приложения.  
- **Законный интерес** — поддержание стабильной работы сервиса, защита от злоупотреблений и мошенничества, аналитика в обезличенном виде.

Вы можете отозвать согласие на отдельные виды обработки (например, доступ к геолокации) через настройки устройства или, при необходимости, обратившись в поддержку.

---

## 5. Передача данных третьим лицам

Мы можем передавать данные третьим лицам в следующих случаях:

1. **Сервис-провайдерам**  
   - хостинг-провайдерам и облачным платформам, где размещён сервер Приложения;  
   - сервисам аналитики и логирования ошибок (например, Firebase Crashlytics или аналогам).

Такие сервисы обрабатывают данные только для целей, указанных нами, и в рамках заключённых договоров.

2. **Если этого требует закон**  
   - по запросу государственных органов при наличии законных оснований.

3. **При реорганизации бизнеса**  
   - в случае продажи или передачи Приложения другому лицу права и обязанности по данной Политике могут быть переданы правопреемнику.

Мы **не продаём** персональные данные пользователей третьим лицам для их маркетинговых целей.

---

## 6. Хранение данных

Мы храним ваши персональные данные:

- пока у вас есть учётная запись в Приложении;  
- или пока данные нужны для целей, указанных в этой Политике;  
- или столько, сколько требуется по закону (например, для бухгалтерии / отчётности).

После истечения сроков хранения данные могут быть удалены или обезличены.

Вы можете запросить удаление своего аккаунта и связанных с ним данных, обратившись в поддержку: **infogouzbekistan@gmail.com**.  
Часть данных (например, резервные копии, лог-файлы) может сохраняться ограниченное время после удаления аккаунта для обеспечения безопасности и выполнения требований законодательства.

---

## 7. Cookies и аналогичные технологии

Если вы используете веб-версию сервиса, мы можем использовать:

- cookies-файлы;  
- локальное хранилище браузера;  
- аналогичные технологии.

Они нужны для:

- авторизации и поддержания сессии;  
- сохранения настроек;  
- аналитики работы сервиса.

Вы можете ограничить использование cookies в настройках браузера, но это может повлиять на работоспособность некоторых функций.

---

## 8. Безопасность данных

Мы предпринимаем технические и организационные меры для защиты данных:

- шифрование соединения (HTTPS);  
- разграничение доступа к данным на сервере;  
- регулярное обновление программного обеспечения;  
- мониторинг инцидентов безопасности.

Однако ни один способ передачи и хранения данных не может быть гарантированно безопасным на 100%. При возникновении инцидента мы предпримем разумные меры для минимизации последствий и уведомления пользователей (если это требуется законом).

---

## 9. Права пользователя

В зависимости от применимого законодательства вы можете иметь следующие права:

- право на доступ к своим персональным данным;  
- право на исправление (обновление) данных;  
- право на удаление данных (право «быть забытым»);  
- право ограничить обработку;  
- право отозвать согласие на обработку (например, геолокации);  
- право подать жалобу в уполномоченный орган.

Чтобы реализовать свои права, напишите нам на **infogouzbekistan@gmail.com** с указанием, что именно вы хотите сделать (получить копию данных, удалить аккаунт и т.д.).

---

## 10. Возрастные ограничения

Приложение **не предназначено** для использования детьми младше 16 лет без согласия родителей или законных представителей.  
Если вы считаете, что мы собираем данные ребёнка без такого согласия, сообщите нам — мы примем меры для удаления информации.

---

## 11. Изменения Политики

Мы можем время от времени обновлять эту Политику.  
Новая версия вступает в силу с момента публикации в Приложении и/или на сайте.  

Если изменения существенные, мы можем дополнительно уведомить вас в Приложении.

---

## 12. Контакты

По всем вопросам, связанным с обработкой персональных данных, вы можете обратиться:

**Email:** infogouzbekistan@gmail.com  
**Telegram:** @InfoGO_official  
**Web-сайт:** infogo.uz  

''';

class PrivacyPolicyScreen extends StatelessWidget {
  const PrivacyPolicyScreen({super.key});

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);

    final baseSheet = MarkdownStyleSheet.fromTheme(theme);
    final baseBody =
        theme.textTheme.bodyMedium ?? baseSheet.p ?? const TextStyle();
    final baseH1 =
        theme.textTheme.titleLarge ?? baseSheet.h1 ?? const TextStyle(fontSize: 22, fontWeight: FontWeight.w700);
    final baseH2 =
        theme.textTheme.titleMedium ?? baseSheet.h2 ?? const TextStyle(fontSize: 18, fontWeight: FontWeight.w600);

    return BaseLayout(
      title: 'Политика конфиденциальности',
      showBackButton: true,
      // если вкладка Профиль — индекс 2, можно поставить 2
      currentIndex: 2,
      showBottomNavigation: false,
      child: Markdown(
        data: _privacyMarkdown,
        padding: const EdgeInsets.fromLTRB(16, 12, 16, 24),
        styleSheet: baseSheet.copyWith(
          p: baseBody.copyWith(height: 1.5),
          h1: baseH1.copyWith(fontWeight: FontWeight.w700),
          h2: baseH2.copyWith(fontWeight: FontWeight.w600),
        ),
      ),
    );
  }
}
